SELECT date_tools_calendar.yrwk AS date_tools_calendar_yrwk, date_tools_calendar.yr AS date_tools_calendar_yr, dh_adminreg_feature_date_tools_calendar.startdate AS dh_adminreg_feature_date_tools_calendar_startdate, dh_adminreg_feature_date_tools_calendar.adminid AS dh_adminreg_feature_date_tools_calendar_adminid, re_date_tools_calendar__field_data_dh_link_feature_submittal.dh_link_feature_submittal_target_id AS re_date_tools_calendar__field_data_dh_link_feature_submittal, dh_timeseries_dh_adminreg_feature.tid AS dh_timeseries_dh_adminreg_feature_tid, dh_timeseries_dh_adminreg_feature.featureid AS dh_timeseries_dh_adminreg_feature_featureid, dh_properties_dh_adminreg_feature_1.propcode AS dh_properties_dh_adminreg_feature_1_propcode, dh_properties_dh_adminreg_feature_2.propvalue AS dh_properties_dh_adminreg_feature_2_propvalue, dh_properties_dh_adminreg_feature_3.propvalue AS dh_properties_dh_adminreg_feature_3_propvalue, dh_properties_dh_adminreg_feature_4.propvalue AS dh_properties_dh_adminreg_feature_4_propvalue, dh_properties_dh_adminreg_feature_5.propvalue AS dh_properties_dh_adminreg_feature_5_propvalue, MIN(date_tools_calendar.ts) AS ts, MAX(dh_properties_dh_adminreg_feature_6.propvalue) AS dh_properties_dh_adminreg_feature_6_propvalue, MIN(dh_adminreg_feature_date_tools_calendar.adminid) AS dh_adminreg_feature_date_tools_calendar_adminid_1, 'dh_adminreg_feature' AS field_data_dh_link_feature_submittal_dh_adminreg_feature_ent, 'dh_adminreg_feature' AS field_data_field_link_to_registered_agchem_dh_adminreg_featu, MIN(dh_properties_dh_adminreg_feature.propvalue) AS dh_properties_dh_adminreg_feature_propvalue
FROM 
{date_tools_calendar} date_tools_calendar
LEFT JOIN {dh_adminreg_feature} dh_adminreg_feature_date_tools_calendar ON date_tools_calendar.ts <= dh_adminreg_feature_date_tools_calendar.startdate AND dh_adminreg_feature_date_tools_calendar.startdate < date_tools_calendar.ts + 86400
LEFT JOIN {field_data_field_link_to_registered_agchem} e_tools_calendar__field_data_field_link_to_registered_agchem ON dh_adminreg_feature_date_tools_calendar.adminid = e_tools_calendar__field_data_field_link_to_registered_agchem.entity_id AND e_tools_calendar__field_data_field_link_to_registered_agchem.entity_type = 'dh_adminreg_feature'
LEFT JOIN {dh_adminreg_feature} _adminreg_feature_field_data_field_link_to_registered_agchem ON e_tools_calendar__field_data_field_link_to_registered_agchem.field_link_to_registered_agchem_target_id = _adminreg_feature_field_data_field_link_to_registered_agchem.adminid
LEFT JOIN {dh_properties} dh_properties_dh_adminreg_feature ON _adminreg_feature_field_data_field_link_to_registered_agchem.adminid = dh_properties_dh_adminreg_feature.featureid AND (dh_properties_dh_adminreg_feature.entity_type = 'dh_adminreg_feature' AND dh_properties_dh_adminreg_feature.varid = ( '93' ))
LEFT JOIN {field_data_dh_link_feature_submittal} re_date_tools_calendar__field_data_dh_link_feature_submittal ON dh_adminreg_feature_date_tools_calendar.adminid = re_date_tools_calendar__field_data_dh_link_feature_submittal.entity_id AND re_date_tools_calendar__field_data_dh_link_feature_submittal.entity_type = 'dh_adminreg_feature'
LEFT JOIN {dh_feature} dh_feature_field_data_dh_link_feature_submittal ON re_date_tools_calendar__field_data_dh_link_feature_submittal.dh_link_feature_submittal_target_id = dh_feature_field_data_dh_link_feature_submittal.hydroid AND dh_feature_field_data_dh_link_feature_submittal.hydroid IN ( '147', '148', '581', '1467', '1540', '5777', '5779', '5780' )
LEFT JOIN {dh_properties} dh_properties_dh_adminreg_feature_1 ON _adminreg_feature_field_data_field_link_to_registered_agchem.adminid = dh_properties_dh_adminreg_feature_1.featureid AND (dh_properties_dh_adminreg_feature_1.entity_type = 'dh_adminreg_feature' AND dh_properties_dh_adminreg_feature_1.varid = ( '112' ))
LEFT JOIN {dh_properties} dh_properties_dh_adminreg_feature_2 ON _adminreg_feature_field_data_field_link_to_registered_agchem.adminid = dh_properties_dh_adminreg_feature_2.featureid AND (dh_properties_dh_adminreg_feature_2.entity_type = 'dh_adminreg_feature' AND dh_properties_dh_adminreg_feature_2.varid = ( '96' ))
LEFT JOIN {dh_properties} dh_properties_dh_adminreg_feature_3 ON _adminreg_feature_field_data_field_link_to_registered_agchem.adminid = dh_properties_dh_adminreg_feature_3.featureid AND (dh_properties_dh_adminreg_feature_3.entity_type = 'dh_adminreg_feature' AND dh_properties_dh_adminreg_feature_3.varid = ( '94' ))
LEFT JOIN {dh_properties} dh_properties_dh_adminreg_feature_4 ON _adminreg_feature_field_data_field_link_to_registered_agchem.adminid = dh_properties_dh_adminreg_feature_4.featureid AND (dh_properties_dh_adminreg_feature_4.entity_type = 'dh_adminreg_feature' AND dh_properties_dh_adminreg_feature_4.varid = ( '95' ))
LEFT JOIN {dh_properties} dh_properties_dh_adminreg_feature_5 ON _adminreg_feature_field_data_field_link_to_registered_agchem.adminid = dh_properties_dh_adminreg_feature_5.featureid AND (dh_properties_dh_adminreg_feature_5.entity_type = 'dh_adminreg_feature' AND dh_properties_dh_adminreg_feature_5.varid = ( '97' ))
LEFT JOIN {field_data_dh_link_facility_mps} a_dh_link_feature_submittal__field_data_dh_link_facility_mps ON dh_feature_field_data_dh_link_feature_submittal.hydroid = a_dh_link_feature_submittal__field_data_dh_link_facility_mps.entity_id AND a_dh_link_feature_submittal__field_data_dh_link_facility_mps.entity_type = 'dh_feature'
LEFT JOIN {dh_feature} dh_feature_field_data_dh_link_facility_mps ON a_dh_link_feature_submittal__field_data_dh_link_facility_mps.dh_link_facility_mps_target_id = dh_feature_field_data_dh_link_facility_mps.hydroid AND dh_feature_field_data_dh_link_facility_mps.hydroid = '146'
LEFT JOIN {dh_properties} dh_properties_dh_adminreg_feature_6 ON dh_adminreg_feature_date_tools_calendar.adminid = dh_properties_dh_adminreg_feature_6.featureid AND (dh_properties_dh_adminreg_feature_6.entity_type = 'dh_adminreg_feature' AND dh_properties_dh_adminreg_feature_6.varid = ( '160' ))
LEFT JOIN {dh_timeseries} dh_timeseries_dh_adminreg_feature ON dh_adminreg_feature_date_tools_calendar.adminid = dh_timeseries_dh_adminreg_feature.featureid AND (dh_timeseries_dh_adminreg_feature.entity_type = 'dh_adminreg_feature' AND dh_timeseries_dh_adminreg_feature.varid = ( '210' ))
WHERE (( (date_tools_calendar.yr = '2021' ) AND (date_tools_calendar.mon >= '3' ) )AND(( (date_tools_calendar.mon BETWEEN '1' AND '12') )AND( (dh_feature_field_data_dh_link_facility_mps.hydroid IS NOT NULL ) AND (dh_adminreg_feature_date_tools_calendar.adminid IS NOT NULL ) )AND( (dh_properties_dh_adminreg_feature.propvalue IS NULL ) OR (dh_properties_dh_adminreg_feature.propvalue > '0') )))
GROUP BY date_tools_calendar.yrwk, date_tools_calendar.yr, dh_adminreg_feature_date_tools_calendar.startdate, dh_adminreg_feature_date_tools_calendar.adminid, field_data_dh_link_feature_submittal_dh_adminreg_feature_ent, re_date_tools_calendar__field_data_dh_link_feature_submittal.dh_link_feature_submittal_target_id, field_data_field_link_to_registered_agchem_dh_adminreg_featu, dh_timeseries_dh_adminreg_feature.tid, dh_timeseries_dh_adminreg_feature.featureid, dh_properties_dh_adminreg_feature_1.propcode, dh_properties_dh_adminreg_feature_2.propvalue, dh_properties_dh_adminreg_feature_3.propvalue, dh_properties_dh_adminreg_feature_4.propvalue, dh_properties_dh_adminreg_feature_5.propvalue
ORDER BY date_tools_calendar_yr ASC, date_tools_calendar_yrwk ASC
